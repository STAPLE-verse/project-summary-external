/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.37.0.
 * Original file: /npm/cal-heatmap@4.2.4/dist/plugins/Legend.esm.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{select as t}from"../../d3-selection@3.0.0/5dcd62f4.js";import{timeSecond as n,timeMinute as e,timeHour as r,timeDay as o,timeWeek as i,timeMonth as a,timeYear as c,timeMonday as u,timeTuesday as s,timeWednesday as l,timeThursday as f,timeFriday as p,timeSaturday as d,timeSunday as h,utcSecond as y,utcMinute as g,utcHour as v,utcDay as m,utcWeek as w,utcMonth as b,utcYear as S,utcMonday as j,utcTuesday as $,utcWednesday as O,utcThursday as k,utcFriday as E,utcSaturday as M,utcSunday as x,geoTransform as T,rgb as N,geoPath as P,geoClipRectangle as C,scaleLinear as R,scalePow as I,scaleLog as A,scaleSymlog as D,quantize as L,scaleQuantile as q,extent as F,ticks as _,interpolateNumber as U,reverse as z,scaleThreshold as W,descending as B,scaleIdentity as G,max as H,scaleDiverging as V,scaleDivergingPow as Y,scaleDivergingLog as J,scaleDivergingSymlog as K,scaleTime as X,scaleUtc as Z,scaleImplicit as Q,scaleOrdinal as tt,scalePoint as nt,scaleBand as et,InternSet as rt,sort as ot,symbolsStroke as it,symbolsFill as at,piecewise as ct,format as ut,axisBottom as st,ascending as lt,color as ft,geoTransverseMercator as pt,geoStereographic as dt,geoOrthographic as ht,geoMercator as yt,geoGnomonic as gt,geoEquirectangular as vt,geoEqualEarth as mt,geoAzimuthalEquidistant as wt,geoAzimuthalEqualArea as bt,geoAlbersUsa as St,select as jt,creator as $t,interpolateRgb as Ot,interpolateRound as kt,min as Et,quantile as Mt,median as xt,utcFormat as Tt,pathRound as Nt,range as Pt,geoConicEquidistant as Ct,geoConicEqualArea as Rt,geoConicConformal as It,geoAlbers as At,schemeAccent as Dt,schemeCategory10 as Lt,schemeDark2 as qt,schemePaired as Ft,schemePastel1 as _t,schemePastel2 as Ut,schemeSet1 as zt,schemeSet2 as Wt,schemeSet3 as Bt,schemeTableau10 as Gt,interpolateBrBG as Ht,interpolatePRGn as Vt,interpolatePiYG as Yt,interpolatePuOr as Jt,interpolateRdBu as Kt,interpolateRdGy as Xt,interpolateRdYlBu as Zt,interpolateRdYlGn as Qt,interpolateSpectral as tn,interpolateBlues as nn,interpolateGreens as en,interpolateGreys as rn,interpolatePurples as on,interpolateReds as an,interpolateOranges as cn,interpolateTurbo as un,interpolateViridis as sn,interpolateMagma as ln,interpolateInferno as fn,interpolatePlasma as pn,interpolateCividis as dn,interpolateCubehelixDefault as hn,interpolateWarm as yn,interpolateCool as gn,interpolateBuGn as vn,interpolateBuPu as mn,interpolateGnBu as wn,interpolateOrRd as bn,interpolatePuBuGn as Sn,interpolatePuBu as jn,interpolatePuRd as $n,interpolateRdPu as On,interpolateYlGnBu as kn,interpolateYlGn as En,interpolateYlOrBr as Mn,interpolateYlOrRd as xn,interpolateRainbow as Tn,interpolateSinebow as Nn,symbolAsterisk as Pn,symbolCircle as Cn,symbolCross as Rn,symbolDiamond as In,symbolDiamond2 as An,symbolPlus as Dn,symbolSquare as Ln,symbolSquare2 as qn,symbolStar as Fn,symbolTimes as _n,symbolTriangle as Un,symbolTriangle2 as zn,symbolWye as Wn,schemeBrBG as Bn,schemePRGn as Gn,schemePiYG as Hn,schemePuOr as Vn,schemeRdBu as Yn,schemeRdGy as Jn,schemeRdYlBu as Kn,schemeRdYlGn as Xn,schemeSpectral as Zn,schemeBlues as Qn,schemeGreens as te,schemeGreys as ne,schemeOranges as ee,schemePurples as re,schemeReds as oe,schemeBuGn as ie,schemeBuPu as ae,schemeGnBu as ce,schemeOrRd as ue,schemePuBu as se,schemePuBuGn as le,schemePuRd as fe,schemeRdPu as pe,schemeYlGn as de,schemeYlGnBu as he,schemeYlOrBr as ye,schemeYlOrRd as ge,interpolateHsl as ve,interpolateHcl as me,interpolateLab as we}from"../../d3@7.9.0/7055d4c5.js";var be="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function Se(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,i=void 0,"symbol"==typeof(i=function(t,n){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(o,"string"))?i:String(i)),r)}var o,i}var je="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==be?be:"undefined"!=typeof self?self:{},$e=function(t){try{return!!t()}catch(t){return!0}},Oe=!$e((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),ke=!$e((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),Ee=ke,Me=Function.prototype,xe=Me.call,Te=Ee&&Me.bind.bind(xe,xe),Ne=Ee?Te:function(t){return function(){return xe.apply(t,arguments)}},Pe=function(t){return null==t},Ce=Pe,Re=TypeError,Ie=function(t){if(Ce(t))throw new Re("Can't call method on "+t);return t},Ae=Ie,De=Object,Le=function(t){return De(Ae(t))},qe=Le,Fe=Ne({}.hasOwnProperty),_e=Object.hasOwn||function(t,n){return Fe(qe(t),n)},Ue=Oe,ze=_e,We=Function.prototype,Be=Ue&&Object.getOwnPropertyDescriptor,Ge=ze(We,"name"),He={EXISTS:Ge,PROPER:Ge&&"something"===function(){}.name,CONFIGURABLE:Ge&&(!Ue||Ue&&Be(We,"name").configurable)},Ve={exports:{}},Ye="object"==typeof document&&document.all,Je={all:Ye,IS_HTMLDDA:void 0===Ye&&void 0!==Ye},Ke=Je.all,Xe=Je.IS_HTMLDDA?function(t){return"function"==typeof t||t===Ke}:function(t){return"function"==typeof t},Ze=function(t){return t&&t.Math===Math&&t},Qe=Ze("object"==typeof globalThis&&globalThis)||Ze("object"==typeof window&&window)||Ze("object"==typeof self&&self)||Ze("object"==typeof je&&je)||Ze("object"==typeof je&&je)||function(){return this}()||Function("return this")(),tr=Qe,nr=Object.defineProperty,er=function(t,n){try{nr(tr,t,{value:n,configurable:!0,writable:!0})}catch(e){tr[t]=n}return n},rr=er,or="__core-js_shared__",ir=Qe[or]||rr(or,{}),ar=Xe,cr=ir,ur=Ne(Function.toString);ar(cr.inspectSource)||(cr.inspectSource=function(t){return ur(t)});var sr,lr,fr=cr.inspectSource,pr=Xe,dr=Qe.WeakMap,hr=pr(dr)&&/native code/.test(String(dr)),yr=Xe,gr=Je.all,vr=Je.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:yr(t)||t===gr}:function(t){return"object"==typeof t?null!==t:yr(t)},mr={},wr=vr,br=Qe.document,Sr=wr(br)&&wr(br.createElement),jr=function(t){return Sr?br.createElement(t):{}},$r=jr,Or=!Oe&&!$e((function(){return 7!==Object.defineProperty($r("div"),"a",{get:function(){return 7}}).a})),kr=Oe&&$e((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Er=vr,Mr=String,xr=TypeError,Tr=function(t){if(Er(t))return t;throw new xr(Mr(t)+" is not an object")},Nr=ke,Pr=Function.prototype.call,Cr=Nr?Pr.bind(Pr):function(){return Pr.apply(Pr,arguments)},Rr=Qe,Ir=Xe,Ar=function(t,n){return arguments.length<2?(e=Rr[t],Ir(e)?e:void 0):Rr[t]&&Rr[t][n];var e},Dr=Ne({}.isPrototypeOf),Lr="undefined"!=typeof navigator&&String(navigator.userAgent)||"",qr=Qe,Fr=Lr,_r=qr.process,Ur=qr.Deno,zr=_r&&_r.versions||Ur&&Ur.version,Wr=zr&&zr.v8;Wr&&(lr=(sr=Wr.split("."))[0]>0&&sr[0]<4?1:+(sr[0]+sr[1])),!lr&&Fr&&(!(sr=Fr.match(/Edge\/(\d+)/))||sr[1]>=74)&&(sr=Fr.match(/Chrome\/(\d+)/))&&(lr=+sr[1]);var Br=lr,Gr=Br,Hr=$e,Vr=Qe.String,Yr=!!Object.getOwnPropertySymbols&&!Hr((function(){var t=Symbol("symbol detection");return!Vr(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Gr&&Gr<41})),Jr=Yr&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Kr=Ar,Xr=Xe,Zr=Dr,Qr=Object,to=Jr?function(t){return"symbol"==typeof t}:function(t){var n=Kr("Symbol");return Xr(n)&&Zr(n.prototype,Qr(t))},no=String,eo=function(t){try{return no(t)}catch(t){return"Object"}},ro=Xe,oo=eo,io=TypeError,ao=function(t){if(ro(t))return t;throw new io(oo(t)+" is not a function")},co=ao,uo=Pe,so=function(t,n){var e=t[n];return uo(e)?void 0:co(e)},lo=Cr,fo=Xe,po=vr,ho=TypeError,yo={exports:{}},go=ir;(yo.exports=function(t,n){return go[t]||(go[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.34.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.34.0/LICENSE",source:"https://github.com/zloirock/core-js"});var vo=yo.exports,mo=Ne,wo=0,bo=Math.random(),So=mo(1..toString),jo=function(t){return"Symbol("+(void 0===t?"":t)+")_"+So(++wo+bo,36)},$o=vo,Oo=_e,ko=jo,Eo=Yr,Mo=Jr,xo=Qe.Symbol,To=$o("wks"),No=Mo?xo.for||xo:xo&&xo.withoutSetter||ko,Po=function(t){return Oo(To,t)||(To[t]=Eo&&Oo(xo,t)?xo[t]:No("Symbol."+t)),To[t]},Co=Cr,Ro=vr,Io=to,Ao=so,Do=function(t,n){var e,r;if("string"===n&&fo(e=t.toString)&&!po(r=lo(e,t)))return r;if(fo(e=t.valueOf)&&!po(r=lo(e,t)))return r;if("string"!==n&&fo(e=t.toString)&&!po(r=lo(e,t)))return r;throw new ho("Can't convert object to primitive value")},Lo=TypeError,qo=Po("toPrimitive"),Fo=function(t,n){if(!Ro(t)||Io(t))return t;var e,r=Ao(t,qo);if(r){if(void 0===n&&(n="default"),e=Co(r,t,n),!Ro(e)||Io(e))return e;throw new Lo("Can't convert object to primitive value")}return void 0===n&&(n="number"),Do(t,n)},_o=to,Uo=function(t){var n=Fo(t,"string");return _o(n)?n:n+""},zo=Oe,Wo=Or,Bo=kr,Go=Tr,Ho=Uo,Vo=TypeError,Yo=Object.defineProperty,Jo=Object.getOwnPropertyDescriptor,Ko="enumerable",Xo="configurable",Zo="writable";mr.f=zo?Bo?function(t,n,e){if(Go(t),n=Ho(n),Go(e),"function"==typeof t&&"prototype"===n&&"value"in e&&Zo in e&&!e[Zo]){var r=Jo(t,n);r&&r[Zo]&&(t[n]=e.value,e={configurable:Xo in e?e[Xo]:r[Xo],enumerable:Ko in e?e[Ko]:r[Ko],writable:!1})}return Yo(t,n,e)}:Yo:function(t,n,e){if(Go(t),n=Ho(n),Go(e),Wo)try{return Yo(t,n,e)}catch(t){}if("get"in e||"set"in e)throw new Vo("Accessors not supported");return"value"in e&&(t[n]=e.value),t};var Qo,ti,ni,ei=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}},ri=mr,oi=ei,ii=Oe?function(t,n,e){return ri.f(t,n,oi(1,e))}:function(t,n,e){return t[n]=e,t},ai=jo,ci=vo("keys"),ui={},si=hr,li=Qe,fi=vr,pi=ii,di=_e,hi=ir,yi=function(t){return ci[t]||(ci[t]=ai(t))},gi=ui,vi="Object already initialized",mi=li.TypeError,wi=li.WeakMap;if(si||hi.state){var bi=hi.state||(hi.state=new wi);bi.get=bi.get,bi.has=bi.has,bi.set=bi.set,Qo=function(t,n){if(bi.has(t))throw new mi(vi);return n.facade=t,bi.set(t,n),n},ti=function(t){return bi.get(t)||{}},ni=function(t){return bi.has(t)}}else{var Si=yi("state");gi[Si]=!0,Qo=function(t,n){if(di(t,Si))throw new mi(vi);return n.facade=t,pi(t,Si,n),n},ti=function(t){return di(t,Si)?t[Si]:{}},ni=function(t){return di(t,Si)}}var ji={set:Qo,get:ti,has:ni,enforce:function(t){return ni(t)?ti(t):Qo(t,{})},getterFor:function(t){return function(n){var e;if(!fi(n)||(e=ti(n)).type!==t)throw new mi("Incompatible receiver, "+t+" required");return e}}},$i=Ne,Oi=$e,ki=Xe,Ei=_e,Mi=Oe,xi=He.CONFIGURABLE,Ti=fr,Ni=ji.enforce,Pi=ji.get,Ci=String,Ri=Object.defineProperty,Ii=$i("".slice),Ai=$i("".replace),Di=$i([].join),Li=Mi&&!Oi((function(){return 8!==Ri((function(){}),"length",{value:8}).length})),qi=String(String).split("String"),Fi=Ve.exports=function(t,n,e){"Symbol("===Ii(Ci(n),0,7)&&(n="["+Ai(Ci(n),/^Symbol\(([^)]*)\)/,"$1")+"]"),e&&e.getter&&(n="get "+n),e&&e.setter&&(n="set "+n),(!Ei(t,"name")||xi&&t.name!==n)&&(Mi?Ri(t,"name",{value:n,configurable:!0}):t.name=n),Li&&e&&Ei(e,"arity")&&t.length!==e.arity&&Ri(t,"length",{value:e.arity});try{e&&Ei(e,"constructor")&&e.constructor?Mi&&Ri(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=Ni(t);return Ei(r,"source")||(r.source=Di(qi,"string"==typeof n?n:"")),t};Function.prototype.toString=Fi((function(){return ki(this)&&Pi(this).source||Ti(this)}),"toString");var _i=Ve.exports,Ui=_i,zi=mr,Wi=function(t,n,e){return e.get&&Ui(e.get,n,{getter:!0}),e.set&&Ui(e.set,n,{setter:!0}),zi.f(t,n,e)},Bi=Oe,Gi=He.EXISTS,Hi=Ne,Vi=Wi,Yi=Function.prototype,Ji=Hi(Yi.toString),Ki=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Xi=Hi(Ki.exec);Bi&&!Gi&&Vi(Yi,"name",{configurable:!0,get:function(){try{return Xi(Ki,Ji(this))[1]}catch(t){return""}}});var Zi={},Qi={},ta={}.propertyIsEnumerable,na=Object.getOwnPropertyDescriptor,ea=na&&!ta.call({1:2},1);Qi.f=ea?function(t){var n=na(this,t);return!!n&&n.enumerable}:ta;var ra=Ne,oa=ra({}.toString),ia=ra("".slice),aa=function(t){return ia(oa(t),8,-1)},ca=$e,ua=aa,sa=Object,la=Ne("".split),fa=ca((function(){return!sa("z").propertyIsEnumerable(0)}))?function(t){return"String"===ua(t)?la(t,""):sa(t)}:sa,pa=fa,da=Ie,ha=function(t){return pa(da(t))},ya=Oe,ga=Cr,va=Qi,ma=ei,wa=ha,ba=Uo,Sa=_e,ja=Or,$a=Object.getOwnPropertyDescriptor;Zi.f=ya?$a:function(t,n){if(t=wa(t),n=ba(n),ja)try{return $a(t,n)}catch(t){}if(Sa(t,n))return ma(!ga(va.f,t,n),t[n])};var Oa=Xe,ka=mr,Ea=_i,Ma=er,xa=function(t,n,e,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:n;if(Oa(e)&&Ea(e,i,r),r.global)o?t[n]=e:Ma(n,e);else{try{r.unsafe?t[n]&&(o=!0):delete t[n]}catch(t){}o?t[n]=e:ka.f(t,n,{value:e,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},Ta={},Na=Math.ceil,Pa=Math.floor,Ca=Math.trunc||function(t){var n=+t;return(n>0?Pa:Na)(n)},Ra=function(t){var n=+t;return n!=n||0===n?0:Ca(n)},Ia=Ra,Aa=Math.max,Da=Math.min,La=Ra,qa=Math.min,Fa=function(t){return t>0?qa(La(t),9007199254740991):0},_a=function(t){return Fa(t.length)},Ua=ha,za=function(t,n){var e=Ia(t);return e<0?Aa(e+n,0):Da(e,n)},Wa=_a,Ba=function(t){return function(n,e,r){var o,i=Ua(n),a=Wa(i),c=za(r,a);if(t&&e!=e){for(;a>c;)if((o=i[c++])!=o)return!0}else for(;a>c;c++)if((t||c in i)&&i[c]===e)return t||c||0;return!t&&-1}},Ga={includes:Ba(!0),indexOf:Ba(!1)},Ha=_e,Va=ha,Ya=Ga.indexOf,Ja=ui,Ka=Ne([].push),Xa=function(t,n){var e,r=Va(t),o=0,i=[];for(e in r)!Ha(Ja,e)&&Ha(r,e)&&Ka(i,e);for(;n.length>o;)Ha(r,e=n[o++])&&(~Ya(i,e)||Ka(i,e));return i},Za=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Qa=Xa,tc=Za.concat("length","prototype");Ta.f=Object.getOwnPropertyNames||function(t){return Qa(t,tc)};var nc={};nc.f=Object.getOwnPropertySymbols;var ec=Ar,rc=Ta,oc=nc,ic=Tr,ac=Ne([].concat),cc=ec("Reflect","ownKeys")||function(t){var n=rc.f(ic(t)),e=oc.f;return e?ac(n,e(t)):n},uc=_e,sc=cc,lc=Zi,fc=mr,pc=$e,dc=Xe,hc=/#|\.prototype\./,yc=function(t,n){var e=vc[gc(t)];return e===wc||e!==mc&&(dc(n)?pc(n):!!n)},gc=yc.normalize=function(t){return String(t).replace(hc,".").toLowerCase()},vc=yc.data={},mc=yc.NATIVE="N",wc=yc.POLYFILL="P",bc=yc,Sc=Qe,jc=Zi.f,$c=ii,Oc=xa,kc=er,Ec=function(t,n,e){for(var r=sc(n),o=fc.f,i=lc.f,a=0;a<r.length;a++){var c=r[a];uc(t,c)||e&&uc(e,c)||o(t,c,i(n,c))}},Mc=bc,xc=function(t,n){var e,r,o,i,a,c=t.target,u=t.global,s=t.stat;if(e=u?Sc:s?Sc[c]||kc(c,{}):(Sc[c]||{}).prototype)for(r in n){if(i=n[r],o=t.dontCallGetSet?(a=jc(e,r))&&a.value:e[r],!Mc(u?r:c+(s?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ec(i,o)}(t.sham||o&&o.sham)&&$c(i,"sham",!0),Oc(e,r,i,t)}},Tc=Xa,Nc=Za,Pc=Object.keys||function(t){return Tc(t,Nc)},Cc=Oe,Rc=Ne,Ic=Cr,Ac=$e,Dc=Pc,Lc=nc,qc=Qi,Fc=Le,_c=fa,Uc=Object.assign,zc=Object.defineProperty,Wc=Rc([].concat),Bc=!Uc||Ac((function(){if(Cc&&1!==Uc({b:1},Uc(zc({},"a",{enumerable:!0,get:function(){zc(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},n={},e=Symbol("assign detection"),r="abcdefghijklmnopqrst";return t[e]=7,r.split("").forEach((function(t){n[t]=t})),7!==Uc({},t)[e]||Dc(Uc({},n)).join("")!==r}))?function(t,n){for(var e=Fc(t),r=arguments.length,o=1,i=Lc.f,a=qc.f;r>o;)for(var c,u=_c(arguments[o++]),s=i?Wc(Dc(u),i(u)):Dc(u),l=s.length,f=0;l>f;)c=s[f++],Cc&&!Ic(a,u,c)||(e[c]=u[c]);return e}:Uc,Gc=Bc;xc({target:"Object",stat:!0,arity:2,forced:Object.assign!==Gc},{assign:Gc});var Hc={};Hc[Po("toStringTag")]="z";var Vc="[object z]"===String(Hc),Yc=Vc,Jc=Xe,Kc=aa,Xc=Po("toStringTag"),Zc=Object,Qc="Arguments"===Kc(function(){return arguments}()),tu=Yc?Kc:function(t){var n,e,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,n){try{return t[n]}catch(t){}}(n=Zc(t),Xc))?e:Qc?Kc(n):"Object"===(r=Kc(n))&&Jc(n.callee)?"Arguments":r},nu=tu,eu=Vc?{}.toString:function(){return"[object "+nu(this)+"]"};Vc||xa(Object.prototype,"toString",eu,{unsafe:!0});var ru="process"===aa(Qe.process),ou=Ne,iu=ao,au=Xe,cu=String,uu=TypeError,su=function(t,n,e){try{return ou(iu(Object.getOwnPropertyDescriptor(t,n)[e]))}catch(t){}},lu=Tr,fu=function(t){if("object"==typeof t||au(t))return t;throw new uu("Can't set "+cu(t)+" as a prototype")},pu=Object.setPrototypeOf||("__proto__"in{}?function(){var t,n=!1,e={};try{(t=su(Object.prototype,"__proto__","set"))(e,[]),n=e instanceof Array}catch(t){}return function(e,r){return lu(e),fu(r),n?t(e,r):e.__proto__=r,e}}():void 0),du=mr.f,hu=_e,yu=Po("toStringTag"),gu=Ar,vu=Wi,mu=Oe,wu=Po("species"),bu=Dr,Su=TypeError,ju=Ne,$u=$e,Ou=Xe,ku=tu,Eu=fr,Mu=function(){},xu=[],Tu=Ar("Reflect","construct"),Nu=/^\s*(?:class|function)\b/,Pu=ju(Nu.exec),Cu=!Nu.test(Mu),Ru=function(t){if(!Ou(t))return!1;try{return Tu(Mu,xu,t),!0}catch(t){return!1}},Iu=function(t){if(!Ou(t))return!1;switch(ku(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Cu||!!Pu(Nu,Eu(t))}catch(t){return!0}};Iu.sham=!0;var Au,Du,Lu,qu,Fu=!Tu||$u((function(){var t;return Ru(Ru.call)||!Ru(Object)||!Ru((function(){t=!0}))||t}))?Iu:Ru,_u=Fu,Uu=eo,zu=TypeError,Wu=Tr,Bu=function(t){if(_u(t))return t;throw new zu(Uu(t)+" is not a constructor")},Gu=Pe,Hu=Po("species"),Vu=ke,Yu=Function.prototype,Ju=Yu.apply,Ku=Yu.call,Xu="object"==typeof Reflect&&Reflect.apply||(Vu?Ku.bind(Ju):function(){return Ku.apply(Ju,arguments)}),Zu=aa,Qu=Ne,ts=function(t){if("Function"===Zu(t))return Qu(t)},ns=ao,es=ke,rs=ts(ts.bind),os=function(t,n){return ns(t),void 0===n?t:es?rs(t,n):function(){return t.apply(n,arguments)}},is=Ar("document","documentElement"),as=Ne([].slice),cs=TypeError,us=/(?:ipad|iphone|ipod).*applewebkit/i.test(Lr),ss=Qe,ls=Xu,fs=os,ps=Xe,ds=_e,hs=$e,ys=is,gs=as,vs=jr,ms=function(t,n){if(t<n)throw new cs("Not enough arguments");return t},ws=us,bs=ru,Ss=ss.setImmediate,js=ss.clearImmediate,$s=ss.process,Os=ss.Dispatch,ks=ss.Function,Es=ss.MessageChannel,Ms=ss.String,xs=0,Ts={},Ns="onreadystatechange";hs((function(){Au=ss.location}));var Ps=function(t){if(ds(Ts,t)){var n=Ts[t];delete Ts[t],n()}},Cs=function(t){return function(){Ps(t)}},Rs=function(t){Ps(t.data)},Is=function(t){ss.postMessage(Ms(t),Au.protocol+"//"+Au.host)};Ss&&js||(Ss=function(t){ms(arguments.length,1);var n=ps(t)?t:ks(t),e=gs(arguments,1);return Ts[++xs]=function(){ls(n,void 0,e)},Du(xs),xs},js=function(t){delete Ts[t]},bs?Du=function(t){$s.nextTick(Cs(t))}:Os&&Os.now?Du=function(t){Os.now(Cs(t))}:Es&&!ws?(qu=(Lu=new Es).port2,Lu.port1.onmessage=Rs,Du=fs(qu.postMessage,qu)):ss.addEventListener&&ps(ss.postMessage)&&!ss.importScripts&&Au&&"file:"!==Au.protocol&&!hs(Is)?(Du=Is,ss.addEventListener("message",Rs,!1)):Du=Ns in vs("script")?function(t){ys.appendChild(vs("script"))[Ns]=function(){ys.removeChild(this),Ps(t)}}:function(t){setTimeout(Cs(t),0)});var As={set:Ss,clear:js},Ds=function(){this.head=null,this.tail=null};Ds.prototype={add:function(t){var n={item:t,next:null},e=this.tail;e?e.next=n:this.head=n,this.tail=n},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var Ls,qs,Fs,_s,Us,zs=Ds,Ws=/ipad|iphone|ipod/i.test(Lr)&&"undefined"!=typeof Pebble,Bs=/web0s(?!.*chrome)/i.test(Lr),Gs=Qe,Hs=os,Vs=Zi.f,Ys=As.set,Js=zs,Ks=us,Xs=Ws,Zs=Bs,Qs=ru,tl=Gs.MutationObserver||Gs.WebKitMutationObserver,nl=Gs.document,el=Gs.process,rl=Gs.Promise,ol=Vs(Gs,"queueMicrotask"),il=ol&&ol.value;if(!il){var al=new Js,cl=function(){var t,n;for(Qs&&(t=el.domain)&&t.exit();n=al.get();)try{n()}catch(t){throw al.head&&Ls(),t}t&&t.enter()};Ks||Qs||Zs||!tl||!nl?!Xs&&rl&&rl.resolve?((_s=rl.resolve(void 0)).constructor=rl,Us=Hs(_s.then,_s),Ls=function(){Us(cl)}):Qs?Ls=function(){el.nextTick(cl)}:(Ys=Hs(Ys,Gs),Ls=function(){Ys(cl)}):(qs=!0,Fs=nl.createTextNode(""),new tl(cl).observe(Fs,{characterData:!0}),Ls=function(){Fs.data=qs=!qs}),il=function(t){al.head||Ls(),al.add(t)}}var ul=il,sl=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},ll=Qe.Promise,fl="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,pl=!fl&&!ru&&"object"==typeof window&&"object"==typeof document,dl=Qe,hl=ll,yl=Xe,gl=bc,vl=fr,ml=Po,wl=pl,bl=fl,Sl=Br;hl&&hl.prototype;var jl=ml("species"),$l=!1,Ol=yl(dl.PromiseRejectionEvent),kl=gl("Promise",(function(){var t=vl(hl),n=t!==String(hl);if(!n&&66===Sl)return!0;if(!Sl||Sl<51||!/native code/.test(t)){var e=new hl((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((e.constructor={})[jl]=r,!($l=e.then((function(){}))instanceof r))return!0}return!n&&(wl||bl)&&!Ol})),El={CONSTRUCTOR:kl,REJECTION_EVENT:Ol,SUBCLASSING:$l},Ml={},xl=ao,Tl=TypeError,Nl=function(t){var n,e;this.promise=new t((function(t,r){if(void 0!==n||void 0!==e)throw new Tl("Bad Promise constructor");n=t,e=r})),this.resolve=xl(n),this.reject=xl(e)};Ml.f=function(t){return new Nl(t)};var Pl,Cl,Rl,Il=xc,Al=ru,Dl=Qe,Ll=Cr,ql=xa,Fl=pu,_l=function(t,n,e){t&&!e&&(t=t.prototype),t&&!hu(t,yu)&&du(t,yu,{configurable:!0,value:n})},Ul=function(t){var n=gu(t);mu&&n&&!n[wu]&&vu(n,wu,{configurable:!0,get:function(){return this}})},zl=ao,Wl=Xe,Bl=vr,Gl=function(t,n){if(bu(n,t))return t;throw new Su("Incorrect invocation")},Hl=function(t,n){var e,r=Wu(t).constructor;return void 0===r||Gu(e=Wu(r)[Hu])?n:Bu(e)},Vl=As.set,Yl=ul,Jl=function(t,n){try{1===arguments.length?console.error(t):console.error(t,n)}catch(t){}},Kl=sl,Xl=zs,Zl=ji,Ql=ll,tf=Ml,nf="Promise",ef=El.CONSTRUCTOR,rf=El.REJECTION_EVENT,of=El.SUBCLASSING,af=Zl.getterFor(nf),cf=Zl.set,uf=Ql&&Ql.prototype,sf=Ql,lf=uf,ff=Dl.TypeError,pf=Dl.document,df=Dl.process,hf=tf.f,yf=hf,gf=!!(pf&&pf.createEvent&&Dl.dispatchEvent),vf="unhandledrejection",mf=function(t){var n;return!(!Bl(t)||!Wl(n=t.then))&&n},wf=function(t,n){var e,r,o,i=n.value,a=1===n.state,c=a?t.ok:t.fail,u=t.resolve,s=t.reject,l=t.domain;try{c?(a||(2===n.rejection&&Of(n),n.rejection=1),!0===c?e=i:(l&&l.enter(),e=c(i),l&&(l.exit(),o=!0)),e===t.promise?s(new ff("Promise-chain cycle")):(r=mf(e))?Ll(r,e,u,s):u(e)):s(i)}catch(t){l&&!o&&l.exit(),s(t)}},bf=function(t,n){t.notified||(t.notified=!0,Yl((function(){for(var e,r=t.reactions;e=r.get();)wf(e,t);t.notified=!1,n&&!t.rejection&&jf(t)})))},Sf=function(t,n,e){var r,o;gf?((r=pf.createEvent("Event")).promise=n,r.reason=e,r.initEvent(t,!1,!0),Dl.dispatchEvent(r)):r={promise:n,reason:e},!rf&&(o=Dl["on"+t])?o(r):t===vf&&Jl("Unhandled promise rejection",e)},jf=function(t){Ll(Vl,Dl,(function(){var n,e=t.facade,r=t.value;if($f(t)&&(n=Kl((function(){Al?df.emit("unhandledRejection",r,e):Sf(vf,e,r)})),t.rejection=Al||$f(t)?2:1,n.error))throw n.value}))},$f=function(t){return 1!==t.rejection&&!t.parent},Of=function(t){Ll(Vl,Dl,(function(){var n=t.facade;Al?df.emit("rejectionHandled",n):Sf("rejectionhandled",n,t.value)}))},kf=function(t,n,e){return function(r){t(n,r,e)}},Ef=function(t,n,e){t.done||(t.done=!0,e&&(t=e),t.value=n,t.state=2,bf(t,!0))},Mf=function(t,n,e){if(!t.done){t.done=!0,e&&(t=e);try{if(t.facade===n)throw new ff("Promise can't be resolved itself");var r=mf(n);r?Yl((function(){var e={done:!1};try{Ll(r,n,kf(Mf,e,t),kf(Ef,e,t))}catch(n){Ef(e,n,t)}})):(t.value=n,t.state=1,bf(t,!1))}catch(n){Ef({done:!1},n,t)}}};if(ef&&(lf=(sf=function(t){Gl(this,lf),zl(t),Ll(Pl,this);var n=af(this);try{t(kf(Mf,n),kf(Ef,n))}catch(t){Ef(n,t)}}).prototype,(Pl=function(t){cf(this,{type:nf,done:!1,notified:!1,parent:!1,reactions:new Xl,rejection:!1,state:0,value:void 0})}).prototype=ql(lf,"then",(function(t,n){var e=af(this),r=hf(Hl(this,sf));return e.parent=!0,r.ok=!Wl(t)||t,r.fail=Wl(n)&&n,r.domain=Al?df.domain:void 0,0===e.state?e.reactions.add(r):Yl((function(){wf(r,e)})),r.promise})),Cl=function(){var t=new Pl,n=af(t);this.promise=t,this.resolve=kf(Mf,n),this.reject=kf(Ef,n)},tf.f=hf=function(t){return t===sf||undefined===t?new Cl(t):yf(t)},Wl(Ql)&&uf!==Object.prototype)){Rl=uf.then,of||ql(uf,"then",(function(t,n){var e=this;return new sf((function(t,n){Ll(Rl,e,t,n)})).then(t,n)}),{unsafe:!0});try{delete uf.constructor}catch(t){}Fl&&Fl(uf,lf)}Il({global:!0,constructor:!0,wrap:!0,forced:ef},{Promise:sf}),_l(sf,nf,!1),Ul(nf);var xf={},Tf=xf,Nf=Po("iterator"),Pf=Array.prototype,Cf=tu,Rf=so,If=Pe,Af=xf,Df=Po("iterator"),Lf=function(t){if(!If(t))return Rf(t,Df)||Rf(t,"@@iterator")||Af[Cf(t)]},qf=Cr,Ff=ao,_f=Tr,Uf=eo,zf=Lf,Wf=TypeError,Bf=Cr,Gf=Tr,Hf=so,Vf=os,Yf=Cr,Jf=Tr,Kf=eo,Xf=function(t){return void 0!==t&&(Tf.Array===t||Pf[Nf]===t)},Zf=_a,Qf=Dr,tp=function(t,n){var e=arguments.length<2?zf(t):n;if(Ff(e))return _f(qf(e,t));throw new Wf(Uf(t)+" is not iterable")},np=Lf,ep=function(t,n,e){var r,o;Gf(t);try{if(!(r=Hf(t,"return"))){if("throw"===n)throw e;return e}r=Bf(r,t)}catch(t){o=!0,r=t}if("throw"===n)throw e;if(o)throw r;return Gf(r),e},rp=TypeError,op=function(t,n){this.stopped=t,this.result=n},ip=op.prototype,ap=function(t,n,e){var r,o,i,a,c,u,s,l=e&&e.that,f=!(!e||!e.AS_ENTRIES),p=!(!e||!e.IS_RECORD),d=!(!e||!e.IS_ITERATOR),h=!(!e||!e.INTERRUPTED),y=Vf(n,l),g=function(t){return r&&ep(r,"normal",t),new op(!0,t)},v=function(t){return f?(Jf(t),h?y(t[0],t[1],g):y(t[0],t[1])):h?y(t,g):y(t)};if(p)r=t.iterator;else if(d)r=t;else{if(!(o=np(t)))throw new rp(Kf(t)+" is not iterable");if(Xf(o)){for(i=0,a=Zf(t);a>i;i++)if((c=v(t[i]))&&Qf(ip,c))return c;return new op(!1)}r=tp(t,o)}for(u=p?t.next:r.next;!(s=Yf(u,r)).done;){try{c=v(s.value)}catch(t){ep(r,"throw",t)}if("object"==typeof c&&c&&Qf(ip,c))return c}return new op(!1)},cp=Po("iterator"),up=!1;try{var sp=0,lp={next:function(){return{done:!!sp++}},return:function(){up=!0}};lp[cp]=function(){return this},Array.from(lp,(function(){throw 2}))}catch(t){}var fp=ll,pp=function(t,n){try{if(!n&&!up)return!1}catch(t){return!1}var e=!1;try{var r={};r[cp]=function(){return{next:function(){return{done:e=!0}}}},t(r)}catch(t){}return e},dp=El.CONSTRUCTOR||!pp((function(t){fp.all(t).then(void 0,(function(){}))})),hp=Cr,yp=ao,gp=Ml,vp=sl,mp=ap;xc({target:"Promise",stat:!0,forced:dp},{all:function(t){var n=this,e=gp.f(n),r=e.resolve,o=e.reject,i=vp((function(){var e=yp(n.resolve),i=[],a=0,c=1;mp(t,(function(t){var u=a++,s=!1;c++,hp(e,n,t).then((function(t){s||(s=!0,i[u]=t,--c||r(i))}),o)})),--c||r(i)}));return i.error&&o(i.value),e.promise}});var wp=xc,bp=El.CONSTRUCTOR,Sp=ll,jp=Ar,$p=Xe,Op=xa,kp=Sp&&Sp.prototype;if(wp({target:"Promise",proto:!0,forced:bp,real:!0},{catch:function(t){return this.then(void 0,t)}}),$p(Sp)){var Ep=jp("Promise").prototype.catch;kp.catch!==Ep&&Op(kp,"catch",Ep,{unsafe:!0})}var Mp=Cr,xp=ao,Tp=Ml,Np=sl,Pp=ap;xc({target:"Promise",stat:!0,forced:dp},{race:function(t){var n=this,e=Tp.f(n),r=e.reject,o=Np((function(){var o=xp(n.resolve);Pp(t,(function(t){Mp(o,n,t).then(e.resolve,r)}))}));return o.error&&r(o.value),e.promise}});var Cp=Cr,Rp=Ml;xc({target:"Promise",stat:!0,forced:El.CONSTRUCTOR},{reject:function(t){var n=Rp.f(this);return Cp(n.reject,void 0,t),n.promise}});var Ip=Tr,Ap=vr,Dp=Ml,Lp=xc,qp=El.CONSTRUCTOR,Fp=function(t,n){if(Ip(t),Ap(n)&&n.constructor===t)return n;var e=Dp.f(t);return(0,e.resolve)(n),e.promise};function _p(t){return null!=t&&!Number.isNaN(t)}function Up(t,n){return+_p(n)-+_p(t)||lt(t,n)}function zp(t){return isFinite(t)?t:NaN}function Wp(t){return t>0&&isFinite(t)?t:NaN}function Bp(t){return t<0&&isFinite(t)?t:NaN}function Gp(t,n){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof n?n(t):n;const e=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${Hp(-a,6)}`:a>9999?`+${Hp(a,6)}`:Hp(a,4)}-${Hp(t.getUTCMonth()+1,2)}-${Hp(t.getUTCDate(),2)}${e||r||o||i?`T${Hp(e,2)}:${Hp(r,2)}${o||i?`:${Hp(o,2)}${i?`.${Hp(i,3)}`:""}`:""}Z`:""}`;var a}function Hp(t,n){return`${t}`.padStart(n,"0")}Ar("Promise"),Lp({target:"Promise",stat:!0,forced:qp},{resolve:function(t){return Fp(this,t)}});const Vp=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function Yp(t,n){return Vp.test(t+="")?new Date(t):"function"==typeof n?n(t):n}const Jp=new Map([["second",n],["minute",e],["hour",r],["day",o],["week",i],["month",a],["quarter",a.every(3)],["half",a.every(6)],["year",c],["monday",u],["tuesday",s],["wednesday",l],["thursday",f],["friday",p],["saturday",d],["sunday",h]]),Kp=new Map([["second",y],["minute",g],["hour",v],["day",m],["week",w],["month",b],["quarter",b.every(3)],["half",b.every(6)],["year",S],["monday",j],["tuesday",$],["wednesday",O],["thursday",k],["friday",E],["saturday",M],["sunday",x]]);function Xp(t){const n=Jp.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown interval: ${t}`);return n}function Zp(t){const n=Kp.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown interval: ${t}`);return n}const Qp=Object.getPrototypeOf(Uint8Array),td=Object.prototype.toString,nd=t=>null==t?t:`${t}`,ed=t=>()=>t;function rd(t){return t instanceof Qp?t:ld(t,od,Float64Array)}function od(t){return null==t?NaN:Number(t)}function id(t){return ld(t,ad)}function ad(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?Yp(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function cd(t,n){return void 0===t&&(t=n),null===t?[void 0,"none"]:function(t){return"string"==typeof t&&(t=t.toLowerCase().trim(),"none"===t||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==ft(t))}(t)?[void 0,t]:[t,void 0]}function ud(t,n){return void 0===t&&(t=n),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function sd(t){return null==t||t instanceof Array||t instanceof Qp?t:Array.from(t)}function ld(t,n,e=Array){return null==t?t:t instanceof e?t.map(n):e.from(t,n)}function fd(t){return t?.toString===td}function pd(t){return fd(t)&&(void 0!==t.type||void 0!==t.domain)}function dd(t,n){if(null!=t){if("number"==typeof t){0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:t=>Math.floor(t*n)/n,offset:t=>(t*n+1)/n,range:(t,e)=>Pt(Math.ceil(t*n),e*n).map((t=>t/n))}:{floor:t=>Math.floor(t/n)*n,offset:t=>t+n,range:(t,e)=>Pt(Math.ceil(t/n),e/n).map((t=>t*n))}}if("string"==typeof t)return("time"===n?Xp:Zp)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function hd(t,n){if((t=dd(t,n))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function yd(t){for(const n of t){if(null==n)continue;const t=typeof n;return"string"===t||"boolean"===t}}function gd(t){for(const n of t)if(null!=n)return n instanceof Date}function vd(t){for(const n of t)if(null!=n)return"string"==typeof n&&isNaN(n)&&Yp(n)}function md(t){for(const n of t)if(null!=n){if("string"!=typeof n)return!1;if(n.trim())return!isNaN(n)}}function wd(t){return null==t||function(t){return/^\s*none\s*$/i.test(t)}(t)}function bd(t){if(null==t)return;const n=t[0],e=t[t.length-1];return B(n,e)}const Sd=Symbol("position"),jd=Symbol("color"),$d=Symbol("radius"),Od=Symbol("length"),kd=Symbol("opacity"),Ed=Symbol("symbol"),Md=new Map([["x",Sd],["y",Sd],["fx",Sd],["fy",Sd],["r",$d],["color",jd],["opacity",kd],["symbol",Ed],["length",Od]]),xd=2/Math.sqrt(3),Td=new Map([["asterisk",Pn],["circle",Cn],["cross",Rn],["diamond",In],["diamond2",An],["hexagon",{draw(t,n){const e=Math.sqrt(n/Math.PI),r=e*xd,o=r/2;t.moveTo(0,r),t.lineTo(e,o),t.lineTo(e,-o),t.lineTo(0,-r),t.lineTo(-e,-o),t.lineTo(-e,o),t.closePath()}}],["plus",Dn],["square",Ln],["square2",qn],["star",Fn],["times",_n],["triangle",Un],["triangle2",zn],["wye",Wn]]);function Nd(t){if(null==t||function(t){return t&&"function"==typeof t.draw}(t))return t;const n=Td.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid symbol: ${t}`)}function Pd(t){console.warn(t)}const Cd=Math.PI,Rd=2*Cd;function Id({projection:t,inset:n=0,insetTop:e=n,insetRight:r=n,insetBottom:o=n,insetLeft:i=n}={},a){if(null==t)return;if("function"==typeof t.stream)return t;let c,u,s="frame";if(fd(t)){let n;if(({type:t,domain:u,inset:n,insetTop:e=(void 0!==n?n:e),insetRight:r=(void 0!==n?n:r),insetBottom:o=(void 0!==n?n:o),insetLeft:i=(void 0!==n?n:i),clip:s=s,...c}=t),null==t)return}"function"!=typeof t&&({type:t}=function(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Ad(St,.7463,.4673);case"albers":return Dd(At,.7463,.4673);case"azimuthal-equal-area":return Ad(bt,4,4);case"azimuthal-equidistant":return Ad(wt,Rd,Rd);case"conic-conformal":return Dd(It,Rd,Rd);case"conic-equal-area":return Dd(Rt,6.1702,2.9781);case"conic-equidistant":return Dd(Ct,7.312,3.6282);case"equal-earth":return Ad(mt,5.4133,2.6347);case"equirectangular":return Ad(vt,Rd,Cd);case"gnomonic":return Ad(gt,3.4641,3.4641);case"identity":return{type:Ld};case"reflect-y":return{type:qd};case"mercator":return Ad(yt,Rd,Rd);case"orthographic":return Ad(ht,2,2);case"stereographic":return Ad(dt,2,2);case"transverse-mercator":return Ad(pt,Rd,Rd);default:throw new Error(`unknown projection type: ${t}`)}}(t));const{width:l,height:f,marginLeft:p,marginRight:d,marginTop:h,marginBottom:y}=a,g=l-p-d-i-r,v=f-h-y-e-o;if(t=t?.({width:g,height:v,clip:s,...c}),null==t)return;s=function(t,n,e,r,o){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return C(n,e,r,o);throw new Error(`unknown projection clip type: ${t}`)}(s,p,h,l-d,f-y);let m,w=p+i,b=h+e;if(null!=u){const[[n,e],[r,o]]=P(t).bounds(u),i=Math.min(g/(r-n),v/(o-e));i>0?(w-=(i*(n+r)-g)/2,b-=(i*(e+o)-v)/2,m=T({point(t,n){this.stream.point(t*i+w,n*i+b)}})):Pd("Warning: the projection could not be fit to the specified domain; using the default scale.")}return m??=0===w&&0===b?Ld():T({point(t,n){this.stream.point(t+w,n+b)}}),{stream:n=>t.stream(m.stream(s(n)))}}function Ad(t,n,e){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:c})=>{const u=t();return null!=a&&u.precision?.(a),null!=i&&u.rotate?.(i),"number"==typeof c&&u.clipAngle?.(c),u.scale(Math.min(r/n,o/e)),u.translate([r/2,o/2]),u},aspectRatio:e/n}}function Dd(t,n,e){const{type:r,aspectRatio:o}=Ad(t,n,e);return{type:t=>{const{parallels:n,domain:e,width:o,height:i}=t,a=r(t);return null!=n&&(a.parallels(n),void 0===e&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const Ld=ed({stream:t=>t}),qd=ed(T({point(t,n){this.stream.point(t,-n)}}));function Fd(t={},n,e){const{document:r=("undefined"!=typeof window?window.document:void 0)}=t;return{document:r,className:e,projection:Id(t,n)}}function _d(t,{document:n}){return jt($t(t).call(n.documentElement))}const Ud=new Map([["accent",Dt],["category10",Lt],["dark2",qt],["paired",Ft],["pastel1",_t],["pastel2",Ut],["set1",zt],["set2",Wt],["set3",Bt],["tableau10",Gt],["brbg",Wd(Bn,Ht)],["prgn",Wd(Gn,Vt)],["piyg",Wd(Hn,Yt)],["puor",Wd(Vn,Jt)],["rdbu",Wd(Yn,Kt)],["rdgy",Wd(Jn,Xt)],["rdylbu",Wd(Kn,Zt)],["rdylgn",Wd(Xn,Qt)],["spectral",Wd(Zn,tn)],["burd",Bd(Yn,Kt)],["buylrd",Bd(Kn,Zt)],["blues",zd(Qn,nn)],["greens",zd(te,en)],["greys",zd(ne,rn)],["oranges",zd(ee,cn)],["purples",zd(re,on)],["reds",zd(oe,an)],["turbo",Gd(un)],["viridis",Gd(sn)],["magma",Gd(ln)],["inferno",Gd(fn)],["plasma",Gd(pn)],["cividis",Gd(dn)],["cubehelix",Gd(hn)],["warm",Gd(yn)],["cool",Gd(gn)],["bugn",zd(ie,vn)],["bupu",zd(ae,mn)],["gnbu",zd(ce,wn)],["orrd",zd(ue,bn)],["pubu",zd(se,jn)],["pubugn",zd(le,Sn)],["purd",zd(fe,$n)],["rdpu",zd(pe,On)],["ylgn",zd(de,En)],["ylgnbu",zd(he,kn)],["ylorbr",zd(ye,Mn)],["ylorrd",zd(ge,xn)],["rainbow",Hd(Tn)],["sinebow",Hd(Nn)]]);function zd(t,n){return({length:e})=>1===e?[t[3][1]]:2===e?[t[3][1],t[3][2]]:(e=Math.max(3,Math.floor(e)))>9?L(n,e):t[e]}function Wd(t,n){return({length:e})=>2===e?[t[3][0],t[3][2]]:(e=Math.max(3,Math.floor(e)))>11?L(n,e):t[e]}function Bd(t,n){return({length:e})=>2===e?[t[3][2],t[3][0]]:(e=Math.max(3,Math.floor(e)))>11?L((t=>n(1-t)),e):t[e].slice().reverse()}function Gd(t){return({length:n})=>L(t,Math.max(2,Math.floor(n)))}function Hd(t){return({length:n})=>L(t,Math.floor(n)+1).slice(0,-1)}function Vd(t){const n=`${t}`.toLowerCase();if(!Ud.has(n))throw new Error(`unknown ordinal scheme: ${n}`);return Ud.get(n)}function Yd(t,n){const e=Vd(t),r="function"==typeof e?e({length:n}):e;return r.length!==n?r.slice(0,n):r}const Jd=new Map([["brbg",Ht],["prgn",Vt],["piyg",Yt],["puor",Jt],["rdbu",Kt],["rdgy",Xt],["rdylbu",Zt],["rdylgn",Qt],["spectral",tn],["burd",t=>Kt(1-t)],["buylrd",t=>Zt(1-t)],["blues",nn],["greens",en],["greys",rn],["purples",on],["reds",an],["oranges",cn],["turbo",un],["viridis",sn],["magma",ln],["inferno",fn],["plasma",pn],["cividis",dn],["cubehelix",hn],["warm",yn],["cool",gn],["bugn",vn],["bupu",mn],["gnbu",wn],["orrd",bn],["pubugn",Sn],["pubu",jn],["purd",$n],["rdpu",On],["ylgnbu",kn],["ylgn",En],["ylorbr",Mn],["ylorrd",xn],["rainbow",Tn],["sinebow",Nn]]);function Kd(t){const n=`${t}`.toLowerCase();if(!Jd.has(n))throw new Error(`unknown quantitative scheme: ${n}`);return Jd.get(n)}const Xd=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Zd(t){return null!=t&&Xd.has(`${t}`.toLowerCase())}const Qd=t=>n=>t(1-n),th=[0,1],nh=new Map([["number",U],["rgb",Ot],["hsl",ve],["hcl",me],["lab",we]]);function eh(t){const n=`${t}`.toLowerCase();if(!nh.has(n))throw new Error(`unknown interpolator: ${n}`);return nh.get(n)}function rh(t,n,e,{type:r,nice:o,clamp:i,zero:a,domain:c=ch(t,e),unknown:u,round:s,scheme:l,interval:f,range:p=(Md.get(t)===$d?sh(e,c):Md.get(t)===Od?lh(e,c):Md.get(t)===kd?th:void 0),interpolate:d=(Md.get(t)===jd?null==l&&void 0!==p?Ot:Kd(void 0!==l?l:"cyclical"===r?"rainbow":"turbo"):s?kt:U),reverse:h}){if(f=hd(f,r),"cyclical"!==r&&"sequential"!==r||(r="linear"),h=!!h,"function"!=typeof d&&(d=eh(d)),1===d.length?(h&&(d=Qd(d),h=!1),void 0===p&&2===(p=Float64Array.from(c,((t,n)=>n/(c.length-1)))).length&&(p=th),n.interpolate((p===th?ed:dh)(d))):n.interpolate(d),a){const[t,n]=F(c);(t>0||n<0)&&(c=function(t,n=Array){return t instanceof n?t.slice():n.from(t)}(c),bd(c)!==Math.sign(t)?c[c.length-1]=0:c[0]=0)}return h&&(c=z(c)),n.domain(c).unknown(u),o&&(n.nice(function(t,n){return!0===t?void 0:"number"==typeof t?t:function(t,n){if((t=hd(t,n))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,n)}(o,r)),c=n.domain()),void 0!==p&&n.range(p),i&&n.clamp(i),{type:r,domain:c,range:p,scale:n,interpolate:d,interval:f}}function oh(t,n,{exponent:e=1,...r}){return rh(t,I().exponent(e),n,{...r,type:"pow"})}function ih(t,n,{domain:e=[0],unknown:r,scheme:o="rdylbu",interpolate:i,range:a=(void 0!==i?L(i,e.length+1):Md.get(t)===jd?Yd(o,e.length+1):void 0),reverse:c}){const u=bd(e=sd(e));if(!isNaN(u)&&!function(t,n){for(let e=1,r=t.length,o=t[0];e<r;++e){const r=B(o,o=t[e]);if(0!==r&&r!==n)return!1}return!0}(e,u))throw new Error(`the ${t} scale has a non-monotonic domain`);return c&&(a=z(a)),{type:"threshold",scale:W(u<0?z(e):e,void 0===a?[]:a).unknown(r),domain:e,range:a}}function ah(t,n=zp){return t.length?[Et(t,(({value:t})=>void 0===t?t:Et(t,n))),H(t,(({value:t})=>void 0===t?t:H(t,n)))]:[0,1]}function ch(t,n){const e=Md.get(t);return(e===$d||e===kd||e===Od?uh:ah)(n)}function uh(t){return[0,t.length?H(t,(({value:t})=>void 0===t?t:H(t,zp))):1]}function sh(t,n){const e=t.find((({radius:t})=>void 0!==t));if(void 0!==e)return[0,e.radius];const r=Mt(t,.5,(({value:t})=>void 0===t?NaN:Mt(t,.25,Wp))),o=n.map((t=>3*Math.sqrt(t/r))),i=30/H(o);return i<1?o.map((t=>t*i)):o}function lh(t,n){const e=xt(t,(({value:t})=>void 0===t?NaN:xt(t,Math.abs))),r=n.map((t=>12*t/e)),o=60/H(r);return o<1?r.map((t=>t*o)):r}function fh(t){for(const{value:n}of t)if(void 0!==n)for(let e of n){if(e>0)return ah(t,Wp);if(e<0)return ah(t,Bp)}return[1,10]}function ph(t){const n=[];for(const{value:e}of t)if(void 0!==e)for(const t of e)n.push(t);return n}function dh(t){return(n,e)=>r=>t(n+r*(e-n))}function hh(t,n,e,r,{type:o,nice:i,clamp:a,domain:c=ah(r),unknown:u,pivot:s=0,scheme:l,range:f,symmetric:p=!0,interpolate:d=(Md.get(t)===jd?null==l&&void 0!==f?Ot:Kd(void 0!==l?l:"rdbu"):U),reverse:h}){s=+s;let[y,g]=c;if(B(y,g)<0&&([y,g]=[g,y],h=!h),y=Math.min(y,s),g=Math.max(g,s),"function"!=typeof d&&(d=eh(d)),void 0!==f&&(d=1===d.length?dh(d)(...f):ct(d,f)),h&&(d=Qd(d)),p){const t=e.apply(s),n=t-e.apply(y),r=e.apply(g)-t;n<r?y=e.invert(t-r):n>r&&(g=e.invert(t+n))}return n.domain([y,s,g]).unknown(u).interpolator(d),a&&n.clamp(a),i&&n.nice(i),{type:o,domain:[y,g],pivot:s,interpolate:d,scale:n}}function yh(t,n,{exponent:e=1,...r}){return hh(t,Y().exponent(e=+e),function(t){return.5===t?wh:{apply:n=>Math.sign(n)*Math.pow(Math.abs(n),t),invert:n=>Math.sign(n)*Math.pow(Math.abs(n),1/t)}}(e),n,{...r,type:"diverging-pow"})}function gh(t,n,{constant:e=1,...r}){return hh(t,K().constant(e=+e),function(t){return{apply:n=>Math.sign(n)*Math.log1p(Math.abs(n/t)),invert:n=>Math.sign(n)*Math.expm1(Math.abs(n))*t}}(e),n,r)}const vh={apply:t=>t,invert:t=>t},mh={apply:Math.log,invert:Math.exp},wh={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function bh(t,n,e,r){return rh(t,n,e,r)}const Sh=Symbol("ordinal");function jh(t,n,e,{type:r,interval:o,domain:i,range:a,reverse:c,hint:u}){return o=hd(o,r),void 0===i&&(i=kh(e,o,t)),"categorical"!==r&&r!==Sh||(r="ordinal"),c&&(i=z(i)),n.domain(i),void 0!==a&&("function"==typeof a&&(a=a(i)),n.range(a)),{type:r,domain:i,range:a,scale:n,hint:u,interval:o}}function $h(t,n,{type:e,interval:r,domain:o,range:i,scheme:a,unknown:c,...u}){let s;if(r=hd(r,e),void 0===o&&(o=kh(n,r,t)),Md.get(t)===Ed)s=function(t){return{fill:Eh(t,"fill"),stroke:Eh(t,"stroke")}}(n),i=void 0===i?function(t){return wd(t.fill)?it:at}(s):ld(i,Nd);else if(Md.get(t)===jd&&(void 0!==i||"ordinal"!==e&&e!==Sh||(i=function(t,n="greys"){const e=new Set,[r,o]=Yd(n,2);for(const n of t)if(null!=n)if(!0===n)e.add(o);else{if(!1!==n)return;e.add(r)}return[...e]}(o,a),void 0!==i&&(a=void 0)),void 0===a&&void 0===i&&(a="ordinal"===e?"turbo":"tableau10"),void 0!==a))if(void 0!==i){const t=Kd(a),n=i[0],e=i[1]-i[0];i=({length:r})=>L((r=>t(n+e*r)),r)}else i=Vd(a);if(c===Q)throw new Error(`implicit unknown on ${t} scale is not supported`);return jh(t,tt().unknown(c),n,{...u,type:e,domain:o,range:i,hint:s})}function Oh(t,n,e,r){let{round:o}=e;return void 0!==o&&t.round(o=!!o),(t=jh(r,t,n,e)).round=o,t}function kh(t,n,e){const r=new rt;for(const{value:n,domain:e}of t){if(void 0!==e)return e();if(void 0!==n)for(const t of n)r.add(t)}if(void 0!==n){const[t,e]=F(r).map(n.floor,n);return n.range(t,n.offset(e))}if(r.size>1e4&&Md.get(e)===Sd)throw new Error(`implicit ordinal domain of ${e} scale has more than 10,000 values`);return ot(r,Up)}function Eh(t,n){let e;for(const{hint:r}of t){const t=r?.[n];if(void 0!==t)if(void 0===e)e=t;else if(e!==t)return}return e}function Mh(t,n,e){return function(t,n=[],e={}){const r=function(t,n,{type:e,domain:r,range:o,scheme:i,pivot:a,projection:c}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==c||(e=Th);for(const{type:t}of n)if(void 0!==t)if(void 0===e)e=t;else if(e!==t)throw new Error(`scale incompatible with channel: ${e} !== ${t}`);if(e===Th)return;if(void 0!==e)return e;if(void 0===r&&!n.some((({value:t})=>void 0!==t)))return;const u=Md.get(t);if(u===$d)return"sqrt";if(u===kd||u===Od)return"linear";if(u===Ed)return"ordinal";if((r||o||[]).length>2)return Nh(u);if(void 0!==r)return yd(r)?Nh(u):gd(r)?"utc":u!==jd||null==a&&!Zd(i)?"linear":"diverging";const s=n.map((({value:t})=>t)).filter((t=>void 0!==t));return s.some(yd)?Nh(u):s.some(gd)?"utc":u!==jd||null==a&&!Zd(i)?"linear":"diverging"}(t,n,e);if(void 0===e.type&&void 0===e.domain&&void 0===e.range&&null==e.interval&&"fx"!==t&&"fy"!==t&&Ph({type:r})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(gd)?Pd(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${xh(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${xh(r)}".`):e.some(vd)?Pd(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${xh(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${xh(r)}".`):e.some(md)&&Pd(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${xh(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${xh(r)}".`)}switch(e.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":e=Ch(n,e,rd);break;case"identity":switch(Md.get(t)){case Sd:e=Ch(n,e,rd);break;case Ed:e=Ch(n,e,Rh)}break;case"utc":case"time":e=Ch(n,e,id)}switch(r){case"diverging":return function(t,n,e){return hh(t,V(),vh,n,e)}(t,n,e);case"diverging-sqrt":return function(t,n,e){return yh(t,n,{...e,exponent:.5})}(t,n,e);case"diverging-pow":return yh(t,n,e);case"diverging-log":return function(t,n,{base:e=10,pivot:r=1,domain:o=ah(n,r<0?Bp:Wp),...i}){return hh(t,J().base(e=+e),mh,n,{domain:o,pivot:r,...i})}(t,n,e);case"diverging-symlog":return gh(t,n,e);case"categorical":case"ordinal":case Sh:return $h(t,n,e);case"cyclical":case"sequential":case"linear":return function(t,n,e){return rh(t,R(),n,e)}(t,n,e);case"sqrt":return function(t,n,e){return oh(t,n,{...e,exponent:.5})}(t,n,e);case"threshold":return ih(t,0,e);case"quantile":return function(t,n,{range:e,quantiles:r=(void 0===e?5:(e=[...e]).length),n:o=r,scheme:i="rdylbu",domain:a=ph(n),unknown:c,interpolate:u,reverse:s}){return void 0===e&&(e=void 0!==u?L(u,o):Md.get(t)===jd?Yd(i,o):void 0),a.length>0&&(a=q(a,void 0===e?{length:o}:e).quantiles()),ih(t,0,{domain:a,range:e,reverse:s,unknown:c})}(t,n,e);case"quantize":return function(t,n,{range:e,n:r=(void 0===e?5:(e=[...e]).length),scheme:o="rdylbu",domain:i=ch(t,n),unknown:a,interpolate:c,reverse:u}){const[s,l]=F(i);let f;return void 0===e?(f=_(s,l,r),f[0]<=s&&f.splice(0,1),f[f.length-1]>=l&&f.pop(),r=f.length+1,e=void 0!==c?L(c,r):Md.get(t)===jd?Yd(o,r):void 0):(f=L(U(s,l),r+1).slice(1,-1),s instanceof Date&&(f=f.map((t=>new Date(t))))),bd(sd(i))<0&&f.reverse(),ih(t,0,{domain:f,range:e,reverse:u,unknown:a})}(t,n,e);case"pow":return oh(t,n,e);case"log":return function(t,n,{base:e=10,domain:r=fh(n),...o}){return rh(t,A().base(e),n,{...o,domain:r})}(t,n,e);case"symlog":return function(t,n,{constant:e=1,...r}){return rh(t,D().constant(e),n,r)}(t,n,e);case"utc":return function(t,n,e){return bh(t,Z(),n,e)}(t,n,e);case"time":return function(t,n,e){return bh(t,X(),n,e)}(t,n,e);case"point":return function(t,n,{align:e=.5,padding:r=.5,...o}){return Oh(nt().align(e).padding(r),n,o,t)}(t,n,e);case"band":return function(t,n,{align:e=.5,padding:r=.1,paddingInner:o=r,paddingOuter:i=("fx"===t||"fy"===t?0:r),...a}){return Oh(et().align(e).paddingInner(o).paddingOuter(i),n,a,t)}(t,n,e);case"identity":return Md.get(t)===Sd?{type:"identity",scale:G()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}(t,void 0===e?void 0:[{hint:e}],{...n})}function xh(t){return"symbol"==typeof t?t.description:t}const Th={toString:()=>"projection"};function Nh(t){switch(t){case Sd:return"point";case jd:return Sh;default:return"ordinal"}}function Ph({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Sh}function Ch(t,{domain:n,...e},r){for(const n of t)void 0!==n.value&&(n.value=r(n.value));return{domain:void 0===n?n:r(n),...e}}function Rh(t){return ld(t,Nd)}const Ih=function(t){let n,e;return(...r)=>((e?.length!==r.length||e.some(((t,n)=>t!==r[n])))&&(e=r,n=t(...r)),n)}((t=>new Intl.NumberFormat(t)));function Ah(t){return Gp(t,"Invalid Date")}function Dh(t,n){if((t=nd(t))!==n)return t}!function(t="en-US"){const n=function(t="en-US"){const n=Ih(t);return t=>null==t||isNaN(t)?void 0:n.format(t)}(t)}();const Lh=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function qh(t){if(void 0===t)return"plot-d6a7b5";if(t=`${t}`,!Lh.test(t))throw new Error(`invalid class name: ${t}`);return t}function Fh(t,n){if("string"==typeof n)t.property("style",n);else if(null!=n)for(const e of t)Object.assign(e.style,n)}function _h(t){return Ph(t)&&void 0===t.interval?void 0:"tabular-nums"}function Uh(t,n){if(null==n)return n;const e=t(n);if(!e)throw new Error(`scale not found: ${n}`);return e}function zh(t,n={},e){let{columns:r,tickFormat:o,fontVariant:i=_h(t),swatchSize:a=15,swatchWidth:c=a,swatchHeight:u=a,marginLeft:s=0,className:l,style:f,width:p}=n;const d=Fd(n);l=qh(l),o=function(t,n){return void 0===t?gd(n)?Ah:nd:"function"==typeof t?t:("string"==typeof t?gd(n)?Tt:ut:ed)(t)}(o,t.domain);const h=_d("div",d).attr("class",`${l}-swatches ${l}-swatches-${null!=r?"columns":"wrap"}`);let y;return null!=r?(y=`.${l}-swatches-columns .${l}-swatch {\n  display: flex;\n  align-items: center;\n  break-inside: avoid;\n  padding-bottom: 1px;\n}\n.${l}-swatches-columns .${l}-swatch::before {\n  flex-shrink: 0;\n}\n.${l}-swatches-columns .${l}-swatch-label {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}`,h.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${l}-swatch`).call(e,t,c,u).call((t=>t.append("div").attr("class",`${l}-swatch-label`).attr("title",o).text(o)))):(y=`.${l}-swatches-wrap {\n  display: flex;\n  align-items: center;\n  min-height: 33px;\n  flex-wrap: wrap;\n}\n.${l}-swatches-wrap .${l}-swatch {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 1em;\n}`,h.selectAll().data(t.domain).enter().append("span").attr("class",`${l}-swatch`).call(e,t,c,u).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),h.call((t=>t.insert("style","*").text(`.${l}-swatches {\n  font-family: system-ui, sans-serif;\n  font-size: 10px;\n  margin-bottom: 0.5em;\n}\n.${l}-swatch > svg {\n  margin-right: 0.5em;\n  overflow: visible;\n}\n${y}`))).style("margin-left",s?+s+"px":null).style("width",void 0===p?null:+p+"px").style("font-variant",Dh(i,"normal")).call(Fh,f).node()}const Wh=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:e=1,stroke:r=(void 0!==t.hint?.stroke?t.hint.stroke:wd(n)?"currentColor":"none"),strokeOpacity:o=1,strokeWidth:i=1.5,r:a=4.5,...c}={},u){const[s,l]=cd(n),[f,p]=cd(r),d=Uh(u,s),h=Uh(u,f),y=a*a*Math.PI;return e=ud(e)[1],o=ud(o)[1],i=ud(i)[1],zh(t,c,((n,r,a,c)=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("width",a).attr("height",c).attr("fill","color"===s?t=>d.scale(t):l).attr("fill-opacity",e).attr("stroke","color"===f?t=>h.scale(t):p).attr("stroke-opacity",o).attr("stroke-width",i).append("path").attr("d",(n=>{const e=Nt();return t.scale(n).draw(e,y),e}))))}],["color",Gh],["opacity",function({type:t,interpolate:n,...e},{legend:r=!0,color:o=N(0,0,0),...i}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===r&&(r="ramp");if("ramp"!==`${r}`.toLowerCase())throw new Error(`${r} opacity legends are not supported`);return Gh({type:t,...e,interpolate:Hh(o)},{legend:r,...i})}]]);function Bh({className:t,...n},{label:e,ticks:r,tickFormat:o}={},i){return function(t={},...n){let e=t;for(const r of n)for(const n in r)if(void 0===e[n]){const o=r[n];e===t?e={...e,[n]:o}:e[n]=o}return e}(i,{className:t,...n},{label:e,ticks:r,tickFormat:o})}function Gh(t,{legend:n=!0,...e}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:n,...e}={}){if(!Ph(t)&&!function({type:t}){return"threshold"===t}(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return zh(t,e,((t,e,r,o)=>t.append("svg").attr("width",r).attr("height",o).attr("fill",e.scale).attr("fill-opacity",ud(n)[1]).append("rect").attr("width","100%").attr("height","100%")))}(t,e);case"ramp":return function(t,n){let{label:e=t.label,tickSize:r=6,width:o=240,height:i=44+r,marginTop:a=18,marginRight:c=0,marginBottom:u=16+r,marginLeft:s=0,style:l,ticks:f=(o-s-c)/64,tickFormat:p,fontVariant:d=_h(t),round:h=!0,opacity:y,className:g}=n;const v=Fd(n);g=qh(g),y=ud(y)[1],null===p&&(p=()=>null);const m=_d("svg",v).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",i).attr("viewBox",`0 0 ${o} ${i}`).call((t=>t.append("style").text(`.${g}-ramp {\n  display: block;\n  background: white;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n  overflow: visible;\n}\n.${g}-ramp text {\n  white-space: pre;\n}`))).call(Fh,l);let w,b=t=>t.selectAll(".tick line").attr("y1",a+u-i);const S=h?(t,n)=>t.rangeRound(n):(t,n)=>t.range(n),{type:j,domain:$,range:O,interpolate:k,scale:E,pivot:M}=t;if(k){const t=void 0===O?k:ct(1===k.length?dh(k):k,O);w=S(E.copy(),L(U(s,o-c),Math.min($.length+(void 0!==M),void 0===O?1/0:O.length)));const n=256,e=v.document.createElement("canvas");e.width=n,e.height=1;const r=e.getContext("2d");for(let e=0,o=n-1;e<n;++e)r.fillStyle=t(e/o),r.fillRect(e,0,1,1);m.append("image").attr("opacity",y).attr("x",s).attr("y",a).attr("width",o-s-c).attr("height",i-a-u).attr("preserveAspectRatio","none").attr("xlink:href",e.toDataURL())}else if("threshold"===j){const t=$,n=void 0===p?t=>t:"string"==typeof p?ut(p):p;w=S(R().domain([-1,O.length-1]),[s,o-c]),m.append("g").attr("fill-opacity",y).selectAll().data(O).enter().append("rect").attr("x",((t,n)=>w(n-1))).attr("y",a).attr("width",((t,n)=>w(n)-w(n-1))).attr("height",i-a-u).attr("fill",(t=>t)),f=ld(t,((t,n)=>n)),p=e=>n(t[e],e)}else w=S(et().domain($),[s,o-c]),m.append("g").attr("fill-opacity",y).selectAll().data($).enter().append("rect").attr("x",w).attr("y",a).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",i-a-u).attr("fill",E),b=()=>{};return m.append("g").attr("transform",`translate(0,${i-u})`).call(st(w).ticks(Array.isArray(f)?null:f,"string"==typeof p?p:void 0).tickFormat("function"==typeof p?p:void 0).tickSize(r).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Dh(d,"normal")).call(b).call((t=>t.select(".domain").remove())),void 0!==e&&m.append("text").attr("x",s).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(e),m.node()}(t,e);default:throw new Error(`unknown legend type: ${n}`)}}function Hh(t){const{r:n,g:e,b:r}=N(t)||N(0,0,0);return t=>`rgba(${n},${e},${r},${t})`}var Vh="#ch-plugin-legend",Yh={enabled:!0,itemSelector:null,label:null,width:130},Jh=function(){function n(t){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),this.name="Legend",this.calendar=t,this.root=null,this.shown=!1,this.options=Yh}var e,r,o;return e=n,r=[{key:"setup",value:function(t){this.options=Object.assign(Object.assign({},Yh),t)}},{key:"paint",value:function(){var n=this.calendar.options.options.scale,e=this.options,r=e.enabled,o=e.itemSelector;if(!r||o&&t(o).empty())return this.destroy();this.shown=!0,this.root=t(o||this.calendar.options.options.itemSelector),this.root.select(Vh).empty()?this.root=this.root.append("div").attr("id",Vh.slice(1)):this.root=this.root.select(Vh);var i=function(t={}){for(const[n,e]of Wh){const r=t[n];if(pd(r)){const o=Fd(t);let i;if("symbol"===n){const{fill:n,stroke:e=(void 0===n&&pd(t.color)?"color":void 0)}=t;i={fill:n,stroke:e}}return e(Mh(n,r,i),Bh(o,r,t),(n=>pd(t[n])?Mh(n,t[n]):null))}}throw new Error("unknown legend type; no scale found")}(Object.assign(Object.assign({},n),this.options));return this.root.selectAll("*").remove(),this.root.append((function(){return i})),Promise.resolve()}},{key:"destroy",value:function(){return null!==this.root&&(this.root.remove(),this.root=null),Promise.resolve()}}],r&&Se(e.prototype,r),o&&Se(e,o),Object.defineProperty(e,"prototype",{writable:!1}),n}();export{Jh as default};
